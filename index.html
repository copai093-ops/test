<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<title>Excel MCQ Test</title>
<style>
body{
  font-family: Arial;
  background:#e8f4f8;
  max-width:900px;
  margin:auto;
  padding:20px;
}
.q{
  background:#fff;
  padding:15px;
  margin:15px 0;
  border-radius:8px;
  display:none;
}
.q label{
  display:block;
  margin:6px 0;
  font-size:16px;
  cursor:pointer;
}
button{
  padding:12px 30px;
  font-size:18px;
  background:green;
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer;
  margin-top:10px;
}
#countdown{
  font-size:20px;
  font-weight:bold;
  color: #d9534f;
  text-align:right;
}
</style>
</head>
<body>

<h1 style="text-align:center;">Excel MCQ Test</h1>

<div id="nameSection" style="text-align:center; margin-top:50px;">
  <input type="text" id="name" placeholder="Apna pura naam likho" style="width:80%;padding:10px;font-size:16px">
  <br>
  <button onclick="startTest()">Next</button>
</div>

<div id="countdown"></div>
<div id="testContent">
  <!-- Questions -->
  <div class="q" id="q1">
    <b>Q1.</b> Excel file ka default extension?
    <label><input type="radio" name="q1" value="A"> .xlsx</label>
    <label><input type="radio" name="q1" value="B"> .xls</label>
    <label><input type="radio" name="q1" value="C"> .csv</label>
    <label><input type="radio" name="q1" value="D"> .xlsm</label>
    <label><input type="radio" name="q1" value="NA" checked> Not Attended</label>
  </div>

  <div class="q" id="q2">
    <b>Q2.</b> Cell address ka example?
    <label><input type="radio" name="q2" value="A"> A1</label>
    <label><input type="radio" name="q2" value="B"> $A$1</label>
    <label><input type="radio" name="q2" value="C"> Both A & B</label>
    <label><input type="radio" name="q2" value="D"> None</label>
    <label><input type="radio" name="q2" value="NA" checked> Not Attended</label>
  </div>

  <!-- Add more questions as needed with ids q3, q4, ... -->

  <button id="nextBtn" onclick="nextQuestion()">Next</button>
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbyhpotBZYrE-8VSQBv3RmZmQrqw6QFoZXT3EqF2Udo0ko8Tlif1F-lhlwBIQcyaof3P/exec";

let currentQ = 0;
let questions = document.querySelectorAll(".q");
let timer;
let timeLeft = 30*60; // 30 min in seconds

function startTest() {
  const name = document.getElementById("name").value.trim();
  if(!name){
    alert("Pehle naam likho");
    return;
  }
  document.getElementById("nameSection").style.display = "none";
  document.getElementById("testContent").style.display = "block";
  showQuestion(0);
  startTimer();
}

function showQuestion(index){
  questions.forEach(q => q.style.display="none");
  if(index < questions.length){
    questions[index].style.display="block";
  } else {
    submitAnswers();
  }
}

function nextQuestion(){
  currentQ++;
  showQuestion(currentQ);
}

function startTimer(){
  timer = setInterval(() => {
    const mins = Math.floor(timeLeft/60);
    const secs = timeLeft % 60;
    document.getElementById("countdown").innerText = `Time left: ${mins}m ${secs}s`;
    if(timeLeft <= 0){
      clearInterval(timer);
      submitAnswers();
    }
    timeLeft--;
  },1000);
}

function getAns(q){
  return document.querySelector(`input[name="${q}"]:checked`).value;
}

function submitAnswers(){
  const name=document.getElementById("name").value.trim();
  const data = {};
  questions.forEach((q,i)=>{
    const qName = `q${i+1}`;
    data[qName] = getAns(qName);
  });
  data.name = name;

  fetch(WEB_APP_URL,{
    method:"POST",
    body:JSON.stringify(data),
    headers:{"Content-Type":"text/plain;charset=utf-8"},
    mode:"no-cors"
  });

  document.body.innerHTML =
    "<h2 style='color:green;text-align:center;margin-top:50px;'>âœ… Test Successfully Submitted</h2>";
}
</script>
</body>
</html>
